<!DOCTYPE html>

<!-- 
█▀ █░█░█ ▄▀█ █▀▄▀█ █   █░█ █▀▀ █▄░█ █▄▀ ▄▀█ ▀█▀
▄█ ▀▄▀▄▀ █▀█ █░▀░█ █   ▀▄▀ ██▄ █░▀█ █░█ █▀█ ░█░


 -->

 <style>
  @import url('https://fonts.googleapis.com/css?family=Urbanist');
  </style>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Swami Venkat ANLY501 Website - Coming Soon</title>
    <link rel="stylesheet" href="styles_r.css" />
  </head>
    <body >

    <!-- About Section -->
    <div class="paragraph" id="introduction">
      <form>
        <form>
          <input type="button" class = button value="<-- Go Back" onclick="history.back()">
         </form>       </form>
      <div class="main__container">
        <div class="main__content">
            <xmp>
                ##############################
                # CLUSTERING
                ##############################
                
                
                ##############################
                # Importing Libraries
                ##############################
                
                library(stats)
                library(NbClust)
                library(cluster)
                library(mclust)
                library(ggplot2)
                library(factoextra)
                library(amap)
                library(purrr)
                library(philentropy)
                library(SnowballC)
                library(caTools)
                library(dplyr)
                library(textstem)
                library(stringr)
                library(wordcloud)
                library(tm)
                library(akmeans)
                library(stylo)
                
                
                
                ##############################
                # Importing the CSV file
                # 12 columns
                # 178 observations
                # Data is cleaned
                ##############################
                
                country <- read.csv("country_average.csv")
                str(country)
                Label <- country$ISO_3DIGIT
                
                
                ##############################
                # Removing Record Label
                # This would be the ISO value of each country
                # Making sure all the values are numeric to do clustering
                ##############################
                
                # remove label
                country <- country[ ,-c(1)]
                str(country)
                # make sure all data points are numeric
                country <- country%>%
                  mutate_all(as.numeric)
                str(country)
                
                
                
                ##############################
                # Creating 3 Distance Matricies
                # Eucledian
                # Manhattan
                # Cosine Similarity
                ##############################
                
                # Euclidean
                M2_Eucl <- dist(country,method="minkowski",p=2)
                # Manhattan
                M1_Man <- dist(country,method="manhattan")
                # Cosine Similarities
                M4 <- dist(country, method="minkowski",p=4)
                CosSim <- stylo::dist.cosine(as.matrix(country))
                
                
                ##############################
                # Visualizing 3 Distance Matricies
                # Eucledian
                # Manhattan
                # Cosine Similarity
                ##############################
                
                # Eucledian Dendrogram
                Hist1 <- hclust(M2_Eucl, method="ward.D2")
                par(cex=1,font=1)
                plot(Hist1, hang=-2, main="Euclidean Dendrogram", xlab="", ylab="", axes=F, labels=Label)
                
                
                # Manhattan Dendrogram
                Hist2 <- hclust(M1_Man, method="ward.D2")
                plot(Hist2, main="Manhattan Dendrogram", xlab="", ylab="", axes=F, labels=Label)
                
                
                # Cluster Dendrogram
                Hist3 <- hclust(M4, method="ward.D2")
                plot(Hist3)
                
                
                # Cosine Similariaty Dendrogram
                Hist4 <- hclust(CosSim, method="ward.D2")
                plot(Hist4, main="Cosine Similarity Dendrogram", xlab="", ylab="", axes=F, labels=Label)
                
                
                
                
                ##############################
                # Visualizing KMeans clustering pt. 1
                # k = 3, 2, 5, 8
                ##############################
                
                fviz_nbclust(country, kmeans,method="wss", k.max=10)
                
                
                # k =3
                k1 <- 3
                kmeansResult1 <- kmeans(country,k1)
                kmeansResult1$centers
                kmeansResult1$size
                
                
                clusterGroups1 <- data.frame(country, kmeansResult1$cluster)
                clusplot(country, kmeansResult1$cluster, color=TRUE,
                         shade=TRUE, labels=2, lines=0)
                
                
                # k = 2
                k2 <- 2
                kmeansResult2 <- kmeans(country,k2)
                kmeansResult2$centers
                kmeansResult2$size
                
                
                clusterGroups2 <- data.frame(country, kmeansResult2$cluster)
                clusplot(country, kmeansResult2$cluster, color=TRUE,
                         shade=TRUE, labels=2, lines=0)
                
                
                # k = 5
                k3 <- 5
                kmeansResult3 <- kmeans(country,k3)
                kmeansResult3$centers
                kmeansResult3$size
                
                
                clusterGroups3 <- data.frame(country, kmeansResult3$cluster)
                clusplot(country, kmeansResult3$cluster, color=TRUE,
                         shade=TRUE, labels=2, lines=0)
                
                
                # k = 8
                k4 <- 8
                kmeansResult4 <- kmeans(country,k4)
                kmeansResult4$centers
                kmeansResult4$size
                
                
                clusterGroups4 <- data.frame(country, kmeansResult4$cluster)
                clusplot(country, kmeansResult4$cluster, color=TRUE,
                         shade=TRUE, labels=2, lines=0)
                
                
                
                
                ##############################
                # Visualizing KMeans clustering pt. 2
                # k = 3, 2, 5, 8
                ##############################
                
                
                fviz_cluster(kmeansResult1, data=country,
                             ellipse.type="convex",
                             palette="jco",
                             axes=c(1,5),
                             main='Cluster Visualization',
                             ggtheme=theme_minimal())
                
                
                fviz_cluster(kmeansResult2, data=country,
                             ellipse.type="convex",
                             palette="jco",
                             axes=c(1,5),
                             main='Cluster Visualization',
                             ggtheme=theme_minimal())
                
                
                fviz_cluster(kmeansResult3, data=country,
                             ellipse.type="convex",
                             palette="jco",
                             axes=c(1,5),
                             main='Cluster Visualization',
                             ggtheme=theme_minimal())
                
                
                fviz_cluster(kmeansResult4, data=country,
                             ellipse.type="convex",
                             palette="jco",
                             axes=c(1,5),
                             main='Cluster Visualization',
                             ggtheme=theme_minimal())
                
                
                ##############################
                # Getting k-means value
                ##############################
                
                
                fviz_nbclust(
                  as.matrix(country),
                  kmeans,
                  k.max=10,
                  method="wss",
                  diss=get_dist(as.matrix(country),method="euclidean")
                )
                
                
                
                ##############################
                # Clustered Dendrogram
                ##############################
                
                hc.cut <- hcut(country, k=3)
                fviz_dend(hc.cut)
                
                hc.cut <- hcut(country, k=2)
                fviz_dend(hc.cut)
                
                hc.cut <- hcut(country, k=5)
                fviz_dend(hc.cut)
                
                hc.cut <- hcut(country, k=8)
                fviz_dend(hc.cut)
                
                
                
                
                
                ##############################
                # Hierarchial Clustering
                ##############################
                
                
                model <- hclust(dist(country), method="complete")
                plot(model, main="Hierarchial Clustering", xlab='', ylab='', axes=F, labels=Label, sub='Countries')
                rect.hclust(model,k=3, border=2:6)
                
                
                model <- hclust(dist(country), method="complete")
                plot(model, main="Hierarchial Clustering", xlab='', ylab='', axes=F, labels=Label, sub='Countries')
                rect.hclust(model,k=2, border=2:6)
                
                
                model <- hclust(dist(country), method="complete")
                plot(model, main="Hierarchial Clustering", xlab='', ylab='', axes=F, labels=Label, sub='Countries')
                rect.hclust(model,k=5, border=2:6)
                
                
                model <- hclust(dist(country), method="complete")
                plot(model, main="Hierarchial Clustering", xlab='', ylab='', axes=F, labels=Label, sub='Countries')
                rect.hclust(model,k=8, border=2:6)
                
                
                
                
                ##############################
                # 3 new vectors
                # Bonus
                ##############################
                
                country[nrow(country) + 1,] = c("X1","99","99","99","99","99","99","99","99","99","99","99","99","99")
                country[nrow(country) + 1,] = c("X2","89","89","89","89","89","89","89","89","89","89","89","89","89")
                country[nrow(country) + 1,] = c("X3","79","79","79","79","79","79","79","79","79","79","79","79","79")



                ##############################
                # Conclusion
                ##############################


                #scattered visual
                fviz_cluster(kmeansResult3, data=country,
                            ellipse.type="concave",
                            palette="lancet",
                            axes=c(1,5),
                            ggtheme=theme_minimal())

                

            </xmp>
            <img style="max-width: 50%; height: auto;" class="center" src="night.gif" alt="weather gif">
      </div>
    </div>
  </body>
</html>